{% load staticfiles %}
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        #farm_box {
        position:   fixed;
        top:        100px;
        left:       100px;
        width:      500px;
        height:     500px;
        border:     solid thin black;
        }

        .evopic_bounding_box {
            text-align: center;
            position: absolute;
            border:     solid thin black;
        }

        .evopic {
            position: relative;
        }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="{% static 'js/jquery-cookie/jquery.cookie.js' %}"></script>
    <script src="{% static 'js/ajax.js' %}"></script>
    <script>
        $(document).ready(function(){
            function populate_map(data) {
                data = JSON.parse(data);
                var farm_output = "";
                for (var i = 0; i < data.length; i++) {
                    var width = (data[i].max_x - data[i].min_x + 1) * 50;
                    var height = (data[i].max_y - data[i].min_y + 1) * 50;
                    var x = (data[i].min_x - 1) / 10 * 100;
                    var y = (data[i].min_y - 1) / 10 * 100;

                    farm_output += "<span class='evopic_bounding_box' style='width:" + width + "px; height:" +
                            height + "px; left: " + x + "%; bottom: " + y + "%'><span class='evopic'>" +
                            data[i].svg + "</span></span>";

                    $("#farm_box").html(farm_output);
                }
            }

            $.post("{% url 'populate_map' %}", function(data,status) {
                populate_map(data);
            });

            $("#move_evos").click(function(){
                $.post("{% url 'move' %}", function(test,status){
                    if(test) {
                        $.post("{% url 'populate_map' %}", function(data,status) {
                            populate_map(data);
                        });
                    }
                });
            });
        });
    </script>


</head>
<body>
<div id="farm_box"></div>
<input type="button" id="move_evos" value="Click!" />
</body>
</html>