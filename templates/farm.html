{% load staticfiles %}
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        #farm_box {
            position: fixed;
            top:      100px;
            left:     100px;
            width:    500px;
            height:   500px;
            background-color: #cbfbb0;
        }

        #dev_box {
            position: fixed;
            top:    610px;
            left:   100px;
            width:  350px;
            border: solid thin black;
        }

        .evopic_bounding_box {
            text-align: center;
            position: absolute;
            border:     solid thin black;
        }

        .evopic {
            position: relative;
        }

        #nav_buttons{
            position: fixed;
            top:      610px;
            left:     500px;
            border: solid thin black;
        }

        #right_button {
            background: url({% static 'img/arrowhead_right_button.png' %}) no-repeat transparent;
            width:14px;
            height:19px;

        }

        #right_button:hover {
            background-image: url({% static 'img/arrowhead_right_button_hover.png' %});
        }

        #right_button:active {
            background-image: url({% static 'img/arrowhead_right_button_click.png' %});
        }

        #left_button {
            background: url({% static 'img/arrowhead_left_button.png' %}) no-repeat transparent;
            width:14px;
            height:19px;

        }

        #left_button:hover {
            background-image: url({% static 'img/arrowhead_left_button_hover.png' %});
        }

        #left_button:active {
            background-image: url({% static 'img/arrowhead_left_button_click.png' %});
        }


        #down_button {
            background: url({% static 'img/arrowhead_down_simp.png' %}) no-repeat transparent;
            width:14px;
            height:19px;

        }

        #down_button:hover {
            background-image: url({% static 'img/arrowhead_down_simp.png' %});
        }

        #down_button:active {
            background-image: url({% static 'img/arrowhead_down_simp.png' %});
        }

        #up_button {
            background: url({% static 'img/arrowhead_down_simp.png' %}) no-repeat transparent;
            width:14px;
            height:19px;

        }

        #up_button:hover {
            background-image: url({% static 'img/arrowhead_down_simp.png' %});
        }

        #up_button:active {
            background-image: url({% static 'img/arrowhead_down_simp.png' %});
        }

    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="{% static 'js/jquery-cookie/jquery.cookie.js' %}"></script>
    <script src="{% static 'js/ajax.js' %}"></script>
    <script>
        $(document).ready(function(){
            var farm_bounds = {min_x: {{min_x}}, min_y: {{min_y}}, max_x: {{max_x}}, max_y: {{max_y}}};

            function post_populate_map()
                {
                $.post ("{% url 'populate_map' %}",  farm_bounds, function(data, status)
                    {
                    populate_map(data);
                    }  );
                }

            function populate_map(server_reply) {
                server_reply = JSON.parse(server_reply);
                var farm_output = "";
                for (var i = 0; i < server_reply.length; i++) {
                    var width = (server_reply[i].max_x - server_reply[i].min_x + 1) * 50;
                    var height = (server_reply[i].max_y - server_reply[i].min_y + 1) * 50;
                    var x = (server_reply[i].min_x - farm_bounds["min_x"]) / 10 * 100;
                    var y = (server_reply[i].min_y - farm_bounds["min_y"]) / 10 * 100;

                    farm_output += "<span class='evopic_bounding_box' style='width:" + width + "px; height:" +
                            height + "px; left: " + x + "%; bottom: " + y + "%'><span class='evopic'>" +
                            server_reply[i].svg + "</span></span>";

                    $("#farm_box").html(farm_output);
                }
            }

            $("#left_button").click(function(){
                farm_bounds["min_x"] - 2 >= 1 ? farm_bounds["min_x"] -= 2 : farm_bounds["min_x"] = 1;
                farm_bounds["max_x"] = farm_bounds["min_x"] + 10;
                $("#dev_box").html(farm_bounds["min_x"] + " " + farm_bounds["max_x"]);
                post_populate_map();
            });

            $("#right_button").click(function(){
                farm_bounds["max_x"] + 2 <= 20 ? farm_bounds["max_x"] += 2 : farm_bounds["max_x"] = 20;
                farm_bounds["min_x"] = farm_bounds["max_x"] - 10;
                $("#dev_box").html(farm_bounds["min_x"] + " " + farm_bounds["max_x"]);
                post_populate_map();
            });

            $("#down_button").click(function(){
                farm_bounds["min_y"] - 2 >= 1 ? farm_bounds["min_y"] -= 2 : farm_bounds["min_y"] = 1;
                farm_bounds["max_y"] = farm_bounds["min_y"] + 10;
                post_populate_map();
            });

            $("#up_button").click(function(){
                farm_bounds["max_y"] + 2 <= 20 ? farm_bounds["max_y"] += 2 : farm_bounds["max_y"] = 20;
                farm_bounds["min_y"] = farm_bounds["max_y"] - 10;
                post_populate_map();
            });

            post_populate_map();

            {% comment %}$("#move_evos").click(function(){
                $.post("{% url 'move' %}", function(test,status){
                    if(test) {
                        $.post("{% url 'populate_map' %}", farm_bounds, function(data, status) {
                            populate_map(data);
                        });
                    }
                });
            });{% endcomment %}
        });
    </script>


</head>
<body>
<div id="farm_box"></div>
{#<input type="button" id="move_evos" value="Click!" />#}
<div id="dev_box"></div>
<div id="nav_buttons">
    <table>
        <tr>
            <td></td>
            <td><div id='up_button'></div></td>
            <td></td>
        </tr>
        <tr>
            <td style="width: 15px;"><div id='left_button'></div></td>
            <td></td>
            <td style="width: 15px;"><div id='right_button'></div></td>
        </tr>
        <tr>
            <td></td>
            <td><div id='down_button'></div></td>
            <td></td>
        </tr>
    </table>

</div>
</body>
</html>